{% extends "main/base_cliente.html" %} {% load static %} {% block content %}

<section class="w-full flex justify-center">
  <div class="w-[80%] mt-20">
    <h1>Detalhes do Grupo</h1>

    {% for grupo in info %}
    <h2>{{ grupo.nome }}</h2>
    {% if grupo.status == 'pendente' %}
    <p>Status: Reserva pendente de confirmação do estabelecimento</p>
    {% else %}
    <p>Status: Reserva confirmada</p>
    {% endif %}

    <h3>Membros:</h3>
    <table>
      <thead>
        <tr>
          <th>Nome</th>
          <th>Valor a Pagar</th>
          <th>Status do Pagamento</th>
        </tr>
      </thead>
      <tbody>
        {% for membro_rel in grupo.statuspagamentomembro_set.all %}
        <tr>
          <td>{{ membro_rel.membro.first_name }} {{ membro_rel.membro.last_name }}</td>
          <td>{{ valor_membro }}</td>
          <td>{{ membro_rel.status_pagamento }}</td>
        </tr>
    <ul>
      {% for membro in grupo.membros.all %}
      <li>{{ membro.first_name }} {{ membro.last_name }}</li>
      {% endfor %}
      </tbody>
    </table>

    <br>
    <form method="post">
      {% csrf_token %}
      <button type="submit" name="realizar_pagamento">Realizar Pagamento</button>
    </form>
    <br>
    </ul>

    <h3>Informações do Estabelecimento:</h3>
    {% if grupo.estabelecimento.userprofile %}
    <p>Endereço: {{ grupo.estabelecimento.userprofile.endereco }}</p>
    <p>
      Valor do Aluguel: R$ {{ grupo.estabelecimento.userprofile.valor_aluguel }}
    </p>
    <p>
      Capacidade de Pessoas: {{ grupo.estabelecimento.userprofile.capacidade_pessoas }}
    </p>
    <p>
      Tipo de Horário: {{ grupo.estabelecimento.userprofile.get_tipo_horario_display }}
    </p>

    <h3>Localização no Mapa:</h3>
    <div class="mapa">
      <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
        {{ mapa|safe }}
        <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    </div>

    {% else %}
    <p>Informações do estabelecimento não disponíveis.</p>

    {% endif %} 
    {% endfor %}
    {% endfor %}
  </div>
</section>
{% endblock %}
